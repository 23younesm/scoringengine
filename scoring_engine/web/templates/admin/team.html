{% extends 'admin/adminbase.html' %}
{% block title %}Admin - {{team.name}}{% endblock %}

{% block head %}
    {{ super() }}
    <script src="//cdn.datatables.net/1.10.12/js/jquery.dataTables.min.js"></script>
    <script src="//cdn.datatables.net/1.10.12/js/dataTables.bootstrap.min.js"></script>
    <link rel="stylesheet" href="//cdn.datatables.net/1.10.12/css/dataTables.bootstrap.min.css" />

    <script src="http://vitalets.github.io/x-editable/assets/jquery/jquery-1.9.1.min.js"></script>
    <script src="http://vitalets.github.io/x-editable/assets/mockjax/jquery.mockjax.js"></script>

    <!-- bootstrap -->
    <!-- <link href="http://vitalets.github.io/x-editable/assets/bootstrap/css/bootstrap.css" rel="stylesheet"> -->
    <link href="http://vitalets.github.io/x-editable/assets/bootstrap/css/bootstrap-responsive.css" rel="stylesheet">
    <script src="http://vitalets.github.io/x-editable/assets/bootstrap/js/bootstrap.js"></script>
    <!-- x-editable (bootstrap) -->
    <link href="http://vitalets.github.io/x-editable/assets/x-editable/bootstrap-editable/css/bootstrap-editable.css" rel="stylesheet">
    <script src="http://vitalets.github.io/x-editable/assets/x-editable/bootstrap-editable/js/bootstrap-editable.js"></script>
    <script src="http://vitalets.github.io/x-editable/assets/demo-mock.js"></script>
    <script src="http://vitalets.github.io/x-editable/assets/demo.js"></script>

    <script>
        $.fn.editable.defaults.mode = 'inline';

        $(function(){
            $('#f').val('bootstrap3');
            $('#c').val('inline');

            $('#frm').submit(function(){
                var f = $('#f').val();
                $(this).attr('action', 'demo-bs3.html');
            });
        });
    </script>

{% endblock %}

{% block admincontent %}
<div class="container">
  <div class="row">
    <div style="width: 80%; margin: auto;">
      <table id="user" class="table table-bordered table-striped" style="clear: both">
        <thead>
          <th>Description</th>
          <th>Value</th>
        </thead>
        <tbody>
          <tr>
            <td width="35%">Text Field</td>
            <td width="65%"><a href="#" id="username" data-type="text" data-pk="1" data-title="Enter username">superuser</a></td>
          </tr>
          <tr>
            <td>Drop Down</td>
            <td><a href="#" id="group" data-type="select" data-pk="1" data-value="5" data-source="/groups" data-title="Select group">Admin</a></td>
          </tr>
        </tbody>
      </table>
    </div>
    <h2>{{team.name}}</h2>
    <div class="panel-body">
      {% for service in team.services %}
        <div class="panel-group">
          <div class="panel panel-default">
            <div class="panel-heading">
              <h4 class="panel-title">
                <a data-toggle="collapse" href="#collapse-{{service.id}}">{{service.name}}</a>
              </h4>
            </div>
            <div id="collapse-{{service.id}}" class="panel-collapse collapse">
              <div class="panel-body">
                <h4>IP Address: {{service.ip_address}}</h4>
                {% if service.environments %}
                  <h4>Environments</h4>
                  <table id="environments" class="table table-striped table-bordered table-compact" cellspacing="0" width="100%">
                    <thead>
                      <tr>
                        <th>Environment ID</th>
                        <th>Matching Regex</th>
                        <th>Name</th>
                        <th>Value</th>
                      </tr>
                    </thead>
                    <tbody>
                      {% for environment in service.environments %}
                        {% for property_obj in environment.properties %}
                        <tr>
                          <td>{{environment.id}}</td>
                          <td>{{environment.matching_regex}}</td>
                          <td>{{property_obj.name}}</td>
                          <td>{{property_obj.value}}</td>
                        </tr>
                        {% endfor %}
                      {% endfor %}
                    </tbody>
                  </table>
                {% endif %}
                <h4>Checks</h4>
                <table id="checks{{service.id}}" class="table table-striped table-bordered table-compact" cellspacing="0" width="100%">
                  <thead>
                    <tr>
                      <th>Round Number</th>
                      <th>Result</th>
                    </tr>
                  </thead>
                  <tbody>
                    {% for check in service.checks_reversed %}
                      <tr>
                        <td>{{check.round.number}}</td>
                        {% if check.result %}
                          <td><span class="label label-success">UP</span></td>
                        {% else %}
                          <td><span class="label label-danger">DOWN</span></td>
                        {% endif %}
                      </tr>
                    {% endfor %}
                  </tbody>
                </table>
                <script>
                    $(document).ready(function() {
                        $('#checks{{service.id}}').DataTable({
                            'paging': true,
                            'bFilter': false,
                            'bInfo': false,
                            "order": [[ 0, "desc" ]]
                        });
                    } );
                </script>
              </div>
            </div>
          </div>
        </div>
      {% endfor %}

    </div>
  </div>
</div>
{% endblock %}